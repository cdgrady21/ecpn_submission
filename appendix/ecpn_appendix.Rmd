---
title: "ecpn_appendix"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
#load()
```

# Appendices

Desired appendices.

- Explaining randomization inference and bootstrapping
- Robustness checks for analysis
    - Additive indices instead of ICW indices
    - Results with differencing method vs results with controlling-for method
    - raw vs ranked variables to create the index
- Placebo analysis + components of placebo
- Balance: 
    - Communities/site: TR vs CO within state & overall for all baseline outcomes (Separate for svy and obs)
    - Individuals: Direct/indirect/control == unneeded because exploratory & no assumption of balance.
- Panel analysis: big table of results (lower priority)
    - Additive indices instead of ICW indices
    - Results with differencing method vs results with controlling-for method
    - raw vs ranked variables to create the index
- *State-level differences & farmer-pastoralist differences*
- Survey questions

## Appendix A: Randomization Inference and Bootstrapping

Randomization inference and bootstrapping are nonparametric methods to generate $p$-values (randomization inference) and confidence intervals (bootstrapping).  With *randomization inference*, we first shuffle the treatment variable to break the relationship between treatment and outcomes.  Next we regress outcomes on treatment using our regression equation and store the resulting coefficient.  Lastly, we repeat that process 10,000 times to create the distribution of coefficients we would observe if treatment had no effect on outcomes -- the null hypothesis.  Our $p$-value is the proportion of the null distribution that is greater than or equal to our observed coefficient.  

*Bootstrapping* for standard errors is similar, but instead of shuffling the treatment indicator we resample units with replacement.  By resampling with replacement, we create the empirical distribution of our data and the range of possible treatment effects we might observe if we repeated the experiment 10,000 times.  The treatment effect at the 2.5th percentile and at the 97.5th percentile are equivalent to a 95\% confidence interval [@efron1994introduction].

In each of these procedures, we mimic our randomization process by randomizing/resampling the intervention to communities in site-level clusters and within state blocks. This means that both communities in an implementation site (farmers and pastoralists) will always be treated/sampled together and that assignment to the intervention and resampling are conducted separately in Nassarawa and Benue, just as the intervention was assigned in this study.  This procedure ensures that our null distribution (for $p$-values) is created by randomizing the intervention between exchangeable units and that our empirical distribution (for confidence intervals) is created by resampling units as they were sampled.

**********

## Appendix B: Robustness checks for community analysis

These tables shows results with different ways of making indices (additive vs inverse-covariance weighted), different models for estimating effects (differencing vs controlling-for), and different ways of coding count variables (raw vs ranked).  Each table is an outcome.  Rows are results for different ways of creating the outcomes.  Columns show the coefficient from OLS regression, true p-value from randomization inference, and a binary "base" indicator showing which method was used in the paper.  

The base method is always inverse-covariance weighted indices; the estimation method is controlling-for unless the baseline difference between the treatment and control groups is 0.20 standard deviations or more; the base method of handling count variables is dense rank. Only contact outcomes use count variables, only survey outcomes have a baseline and an endline and are measured with indices.

```{r, echo=F}
load("../data_and_code/survey_dat/d_analysis/list_of_coefs_and_ps.Rda")
load("../data_and_code/survey_dat/d_analysis/list_of_rank_bin_raw.Rda")

#newList[[3]]
#var_tab

attitude_tab <- newList[[1]][,c(1:2,4)]
colnames(attitude_tab) <- c("coefficient", "p-value", "base")
rownames(attitude_tab) <- c("Controlling-for & ICW", "Controlling-for & Additive",
                            "Differencing & ICW", "Differencing & Additive")
attitude_tab <- round(attitude_tab,3)
attitude_tab <- knitr::kable(attitude_tab, format="latex")
```

\begin{table}[H]
\begin{center}
\label{tab:attitude_tab}
\caption{\textbf{Attitudes.} Effect of ECPN on attitudes using alternative methods of estimation and index construction. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r attitude_tab`
\end{center}
\end{table}

```{r}
security_tab <- newList[[2]][,c(1:2,4)]
colnames(security_tab) <- c("coefficient", "p-value", "base")
rownames(security_tab) <- c("Controlling-for & ICW", "Controlling-for & Additive",
                            "Differencing & ICW", "Differencing & Additive")
security_tab <- round(security_tab,3)
security_tab <- knitr::kable(security_tab, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:security_tab}
\caption{\textbf{Perceptions of Security} Effect of ECPN on perceptions of security using alternative methods of estimation and index construction. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r security_tab`
\end{center}
\end{table}


```{r}
contact_tab <- newList[[3]][,c(1:2,4)]
var_tab$base <- c(0,0,0,1,0,0)
var_tab <- var_tab[c(2,3,5,6),]
contact_tab <- rbind(contact_tab, var_tab)
colnames(contact_tab) <- c("coefficient", "p-value", "base")
rownames(contact_tab) <- c("Controlling-for & ICW & Ranks", "Controlling-for & Additive & Ranks",
                            "Differencing & ICW & Ranks", "Differencing & Additive & Ranks",
                           "Controlling-for & ICW & Categories",
                           "Controlling-for & ICW & Raw",
                           "Differencing & ICW & Categories",
                           "Differencing & ICW & Raw")
contact_tab <- round(contact_tab,3)
contact_tab <- knitr::kable(contact_tab, format="latex")


```

\begin{table}[H]
\begin{center}
\label{tab:contact_tab}
\caption{\textbf{Contact} Effect of ECPN on contact using alternative methods of estimation, index construction, and measuring count variables. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r contact_tab`
\end{center}
\end{table}

```{r}
percExp_tab <- newList[[4]][c(1,3),c(1:2,4)]
colnames(percExp_tab) <- c("coefficient", "p-value", "base")
rownames(percExp_tab) <- c("Controlling-for",
                            "Differencing")
percExp_tab <- round(percExp_tab,3)
percExp_tab <- knitr::kable(percExp_tab, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:percExp_tab}
\caption{\textbf{Contact Willingness (Percent Experiment)} Effect of ECPN on willingness to have contact with the outgroup using alternative methods of estimation. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r percExp_tab`
\end{center}
\end{table}

```{r}
endExp_tab <- newList[[5]][c(1,3),c(1:2,4)]
colnames(endExp_tab) <- c("coefficient", "p-value", "base")
rownames(endExp_tab) <- c("Controlling-for",
                            "Differencing")
endExp_tab <- round(endExp_tab,3)
endExp_tab <- knitr::kable(endExp_tab, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:endExp_tab}
\caption{\textbf{Endorsement Experiment} Effect of ECPN on endorsement experiment using alternative methods of estimation. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r endExp_tab`
\end{center}
\end{table}

```{r}
pgg_tab <- rbind(newList[[6]][1,c(1:2)], newList[[7]][1,c(1:2)])
colnames(pgg_tab) <- c("coefficient", "p-value")
rownames(pgg_tab) <- c("Donation (binary)",
                            "Donation amount")
pgg_tab <- round(pgg_tab,3)
pgg_tab <- knitr::kable(pgg_tab, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:pgg_tab}
\caption{\textbf{Publid Goods Game} Effect of ECPN on probability of donating and on donation amount. The first column shows coefficients from OLS regression and the second column shows $p$-values from randomization inference.}
\smallskip
`r pgg_tab`
\end{center}
\end{table}


## Appendix C: Robustness checks for individual analysis

These tables shows results with different ways of making indices (additive vs inverse-covariance weighted), different models for estimating effects (differencing vs controlling-for), and different ways of coding count variables (raw vs ranked).  Each table is an outcome.  Rows are results for different ways of creating the outcomes.  Columns show the coefficient from OLS regression, true p-value from randomization inference, and a binary "base" indicator showing which method was used in the paper.  

The base method is always inverse-covariance weighted indices; the estimation method is controlling-for unless the baseline difference between the participants and control groups is 0.20 standard deviations or more; the base method of handling count variables is dense rank. Only contact outcomes use count variables, only survey outcomes have a baseline and an endline and are measured with indices.

```{r, echo=F}
load("../data_and_code/survey_dat/d_analysis/list_of_coefs_and_ps_ind.Rda")
load("../data_and_code/survey_dat/d_analysis/list_of_rank_bin_raw_ind.Rda")

#newList_ind[[3]]
#var_tab_ind

attitude_tab_ind <- newList_ind[[1]][,c(1:2,4)]
colnames(attitude_tab_ind) <- c("coefficient", "p-value", "base")
rownames(attitude_tab_ind) <- c("Non: Controlling-for & ICW", "Part: Controlling-for & ICW", 
                                "Non: Controlling-for & Additive", "Part: Controlling-for & Additive",
                                "Non: Differencing & ICW", "Part: Differencing & ICW", 
                                "Non: Differencing & Additive", "Part: Differencing & Additive")
attitude_tab_ind <- round(attitude_tab_ind,3)
attitude_tab_ind <- knitr::kable(attitude_tab_ind, format="latex")
```

\begin{table}[H]
\begin{center}
\label{tab:attitude_tab_ind}
\caption{\textbf{Indiviaul Attitudes.} Effect of ECPN on attitudes using alternative methods of estimation and index construction. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r attitude_tab_ind`
\end{center}
\end{table}

```{r}
security_tab_ind <- newList_ind[[2]][,c(1:2,4)]
colnames(security_tab_ind) <- c("coefficient", "p-value", "base")
rownames(security_tab_ind) <- c("Non: Controlling-for & ICW", "Part: Controlling-for & ICW", 
                                "Non: Controlling-for & Additive", "Part: Controlling-for & Additive",
                                "Non: Differencing & ICW", "Part: Differencing & ICW", 
                                "Non: Differencing & Additive", "Part: Differencing & Additive")
security_tab_ind <- round(security_tab_ind,3)
security_tab_ind <- knitr::kable(security_tab_ind, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:security_tab_ind}
\caption{\textbf{Individual Perceptions of Security} Effect of ECPN on perceptions of security using alternative methods of estimation and index construction. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r security_tab_ind`
\end{center}
\end{table}


```{r}
contact_tab_ind <- newList_ind[[3]][,c(1:2,4)]
var_tab_ind$base <- c(0,0,0,0,0,0,1,1,0,0,0,0)
var_tab_ind <- var_tab_ind[c(3:6,9:nrow(var_tab_ind)),]
contact_tab_ind <- rbind(contact_tab_ind, var_tab_ind)
colnames(contact_tab_ind) <- c("coefficient", "p-value", "base")
rownames(contact_tab_ind) <- c("Non: Controlling-for & ICW & Ranks", "Part: Controlling-for & ICW & Ranks",
                               "Non: Controlling-for & Additive & Ranks", "Part: Controlling-for & Additive & Ranks",
                               "Non: Differencing & ICW & Ranks", "Part: Differencing & ICW & Ranks",
                               "Non: Differencing & Additive & Ranks", "Part: Differencing & Additive & Ranks",
                               "Non: Controlling-for & ICW & Categories", "Part: Controlling-for & ICW & Categories",
                               "Non: Controlling-for & ICW & Raw", "Part: Controlling-for & ICW & Raw",
                               "Non: Differencing & ICW & Categories", "Part: Differencing & ICW & Categories",
                               "Non: Differencing & ICW & Raw", "Part: Differencing & ICW & Raw")
contact_tab_ind <- round(contact_tab_ind,3)
contact_tab_ind <- knitr::kable(contact_tab_ind, format="latex")


```

\begin{table}[H]
\begin{center}
\label{tab:contact_tab_ind}
\caption{\textbf{Individual Contact} Effect of ECPN on contact using alternative methods of estimation, index construction, and measuring count variables. The first column shows coefficients from OLS regression, the second column shows $p$-values from randomization inference, and the third column shows which method was used in the paper.}
\smallskip
`r contact_tab_ind`
\end{center}
\end{table}

```{r}
pgg_tab_ind <- rbind(newList_ind[[4]][c(1,2),c(1:2)], newList_ind[[5]][c(1,2),c(1:2)])
colnames(pgg_tab_ind) <- c("coefficient", "p-value")
rownames(pgg_tab_ind) <- c("Non: Donation (binary)", "Part: Donation (binary)",
                            "Non: Donation amount", "Part: Donation amount")
pgg_tab_ind <- round(pgg_tab_ind,3)
pgg_tab_ind <- knitr::kable(pgg_tab_ind, format="latex")

```

\begin{table}[H]
\begin{center}
\label{tab:pgg_tab_ind}
\caption{\textbf{Individual Publid Goods Game} Effect of ECPN on probability of donating and on donation amount. The first column shows coefficients from OLS regression and the second column shows $p$-values from randomization inference.}
\smallskip
`r pgg_tab_ind`
\end{center}
\end{table}


## Appendix D: Balance Tests

```{r}
load("balTests.rda")
bal_obs
bal_svy
```

## Appendix E: Placebo tests

```{r}
load("../data_and_code/survey_dat/d_analysis/pl_list_of_coefs_and_ps.Rda")

placeboList
```

## Appendix F: State-level differences

```{r}
load("../data_and_code/survey_dat/d_analysis/state_list.Rda")
stateList

```

## Appendix G: Farmer-pastoralist differences

```{r}
load("../data_and_code/survey_dat/d_analysis/farm_list.Rda")
farmList
```


**********
<!--
## Old Appendix B: Results with Additive Indices

These tables show results for self-report survey outcomes made with additive indices.  The tables include the coefficients and $p$-values with additive indices for community- and individual-level analyses.

```{r, echo=F}
load("../data_and_code/survey_dat/d_analysis/diss_appendix/add_ind_tab.Rdata")
```

\begin{table}[H]
\begin{center}
`r add_ind_tab`
\caption{\label{tab:add_ind_tab}\textbf{Effect of ECPN on main outcomes with additive indices.} The first and second columns are coefficients and $p$-values for aggregate community-level analyses.  The third and fourth columns are coefficients and $p$-values for individual-level analyses.}
\end{center}
\end{table}


## OLD Appendix C: Mechanisms and Placebo Analysis

These tables show results for mechanism and placebo outcomes using inverse-covariance weighted indices.  The tables include the coefficients and $p$-values for community- and individual-level analyses.

```{r, echo=F, eval=F}
load("paper1_files/mech_ind_tab.Rdata")
```


## Old Appendix X: Individual-level analysis

```{r, eval=F}
load("../b_creating_outcomes/f2-panelData.Rdata")
table(panel.df$community, panel.df$committee, panel.df$treatment)

```

We approximately 300 baseline respondents, roughly evenly spread throughout all communities (between 8 and 15 respondents per community). Participants are clustered in certain communities where they could more easily be identified during our endline survey.
-->
## Appendix Z: Survey Questions

**Attitudes**

- With regards to someone from [X GROUP], would you feel comfortable:
    - if they worked in your field?
    - paying them to watch your animals?
    - trading goods with them?
    - sharing a meal with them?
    - with a close relative marrying a person from [X GROUP]?
- From 1-5, how much do you trust people from [X GROUP] in your area?
- Now I’m going to ask you questions about your community here in Benue/Nassarawa, including [X GROUP].  Please tell me how strongly you agree/disagree with each of the following statements: People in this area can be trusted.

**Contact**

- Now I’m going to ask you questions about your contact with [X GROUP] in your area.
    - Think of the market you go to most frequently. During the past month, have members of X GROUP gone to that market too?  In the past month, how many times did you interact with X group in the market?
- In the past month, have you:
    - Joined a member of X group for a social event outside the home?  How often?
    - Hosted a member of X group for a ceremony in your home?  How often?
    - Gone to the home of a member of X group for a ceremony?  How often?
    - Have you interacted with members of X group in any other way in the past month?

**Insecurity**

- In the last year were there any areas that you avoided going to or through because of insecurity during the night? 
- In the last year were there any areas that you avoided going to or through because of insecurity, during the day?
- In the last year, did insecurity ever prevent you from: 
    - Working when you wanted to work? About how many days were you unable to work?
    - Going to the market?
    - Getting water for the household?
    - Going to your field/farm?
    - Moving your animals to grazing areas?
    - Moving your animals to water?
    - Earning money or going to work?
    - Going to school?

**Endorsement Experiment**

- Imagine that there is a proposal by [**the Farmer’s Cooperative Society**/**MACBAN**] for action to enhance access to clean water in rural areas.  Though expensive, the proposal aims to bring fresh, clean water to hundreds of areas without access to it, including this one.  If this were proposed, how would you feel about it?

**Percent Experiemnt**

- Think about groups that you might join in your leisure time.  Would you join a group that had **5/25/50/75**% X Group members?
- Think about the community you live in.  Would you live in a community that had **5/25/50/75**% X Group members?


**Violence Placebo**

- Now I am going to ask you some questions about the use of violence.  Is it always, sometimes, rarely, or never justified to use violence to do each of the following:
    - Retaliate against violence
    - Defend one's group
    - Maintain culture and traditions
    - Defend one's religion
    - Bring criminals to justice
    - Force the government to change their policies

**Public Goods Game**

"Thank you very much for participating in our survey.  Before I go, there is one last thing.  As you may have heard, we have development funds to use in this community.  We have randomly selected you as one of the 50 people to receive these funds.  These funds are not for a Mercy Corps project, but rather for you to keep personally or to donate to a community fund.   

We have 1,000 Naira to give to you.  It is yours, and you can use it either way--for yourself or for a community good.

Your community and [joint farmer/pastoralist community] have created a project committee to whom you can donate this money so that it may be used to help both communities.  The project committee has 4  people from each community.  We have found a donor that will match the funds that you all contribute to the project committee, so that if you donate 100 Naira the project committee receives 300 Naira, and if you donate all 1,000 Naira the project committee receives 3,000 Naira.  You are welcome to donate none, some, or all of the money to the project committee.

These are your individual donation envelopes.  All the donations will be private -- only you will know how much money you donated. It essential that you keep how much you give private -- please do not tell anyone.  I have with me a donation envelope to collect donations.  Please go into your home, put however much of the 1,000 Naira you wish to donate to the project committee in the envelope, take whatever amount you want to keep for yourself, and come back to place your envelope in the donation envelope.  Remember, you are welcome to donate none, some, or all of the money to the project committee.  After that we are finished and you may continue your day.  We will come back and publicly announce how much money your community's project committee will receive."